{
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "ec2Allow",
        "Effect": "Allow",
        "Action": [
          "ec2:CreateFlowLogs",
          "ec2:CreateImage",        
          "ec2:CreateNetworkInsights*",
          "ec2:CreateSnapshot*",
          "ec2:CreateTags",
          "ec2:DeleteNetworkInsights*",
          "ec2:ModifyVolume*",
          "ec2:MonitorInstances",
          "ec2:RebootInstances",
          "ec2:StartInstances",
          "ec2:StartNetworkInsights*",
          "ec2:StopInstances",
          "ec2:UnmonitorInstances",
          "ec2:TerminateInstances"
        ],
        "Resource": "*"
      },
      {
        "Sid": "ec2Deny",
        "Effect": "Deny",
        "Action": [
          "ec2:AllocateAddress",
          "ec2:AssignPrivateIpAddresses",
          "ec2:AssociateAddress",
          "ec2:AssociateIamInstanceProfile",
          "ec2:AssociateTrunkInterface",
          "ec2:AttachNetworkInterface",
          "ec2:AttachVolume",
          "ec2:AuthorizeSecurityGroup*",
          "ec2:CopyImage",
          "ec2:CopySnapshot",
          "ec2:CreateLaunchTemplate*",
          "ec2:CreateNetworkInterface",
          "ec2:CreateReplaceRootVolumeTask",
          "ec2:CreateSecurityGroup",
          "ec2:CreateVolume",
          "ec2:DeleteSecurityGroup",
          "ec2:DetachVolume",
          "ec2:DisassociateAddress",
          "ec2:DisassociateIamInstanceProfile",
          "ec2:DisassociateTrunkInterface",
          "ec2:ModifyInstanceAttribute",
          "ec2:ModifyInstanceMetadataOptions",
          "ec2:ModifyLaunchTemplate",
          "ec2:ModifyNetworkInterfaceAttribute",
          "ec2:ModifyPrivateDnsNameOptions",
          "ec2:ModifySecurityGroupRules",
          "ec2:ReplaceIamInstanceProfileAssociation",
          "ec2:ResetInstanceAttribute",
          "ec2:ResetNetworkInterfaceAttribute",
          "ec2:RevokeSecurityGroupEgress",
          "ec2:RevokeSecurityGroupIngress",
          "ec2:RunInstances",
          "ec2:RunScheduledInstances",
          "ec2:UnassignPrivateIpAddresses",
          "ec2:UpdateSecurityGroupRuleDescriptionsEgress",
          "ec2:UpdateSecurityGroupRuleDescriptionsIngress",
          "ec2:Accept*",
          "ec2:AdvertiseByoipCidr",
          "ec2:AllocateHosts",
          "ec2:AllocateIpamPoolCidr",
          "ec2:ApplySecurityGroupsToClientVpnTargetNetwork",
          "ec2:AssociateClientVpnTargetNetwork",
          "ec2:AssociateDhcpOptions",
          "ec2:AssociateInstanceEventWindow",
          "ec2:AssociateRouteTable",
          "ec2:AssociateSubnetCidrBlock",
          "ec2:AssociateTransitGateway*",
          "ec2:AssociateVpcCidrBlock",
          "ec2:AttachClassicLinkVpc",
          "ec2:AttachInternetGateway",
          "ec2:AttachVpnGateway",
          "ec2:AuthorizeClientVpnIngress",
          "ec2:Cancel*",
          "ec2:CreateCapacity*",
          "ec2:CreateCarrierGateway",
          "ec2:CreateClientVpn*",
          "ec2:CreateCoip*",
          "ec2:CreateCustomerGateway",
          "ec2:CreateDefaultSubnet",
          "ec2:CreateDefaultVpc",
          "ec2:CreateDhcpOptions",
          "ec2:CreateEgressOnlyInternetGateway",
          "ec2:CreateFleet",
          "ec2:CreateInstance*",
          "ec2:CreateInternetGateway",
          "ec2:CreateIpam*",
          "ec2:CreateKeyPair",
          "ec2:CreateLocalGateway*",
          "ec2:CreateManagedPrefixList",
          "ec2:CreateNatGateway",
          "ec2:CreateNetworkAcl",
          "ec2:CreateNetworkAclEntry",
          "ec2:CreatePlacementGroup",
          "ec2:CreatePublicIpv4Pool",
          "ec2:CreateReservedInstancesListing",
          "ec2:CreateRoute",
          "ec2:CreateRouteTable",
          "ec2:CreateSubnet",
          "ec2:CreateSubnetCidrReservation",
          "ec2:CreateTrafficMirror*",
          "ec2:CreateTransitGateway*",
          "ec2:CreateVpc*",
          "ec2:CreateVpn*",
          "ec2:DeleteCarrierGateway",
          "ec2:DeleteClientVpn*",
          "ec2:DeleteCoip*",
          "ec2:DeleteCustomerGateway",
          "ec2:DeleteDhcpOptions",
          "ec2:DeleteEgressOnlyInternetGateway",
          "ec2:DeleteFlowLogs",
          "ec2:DeleteInternetGateway",
          "ec2:DeleteIpam*",
          "ec2:DeleteKeyPair",
          "ec2:DeleteLaunchTemplate*",
          "ec2:DeleteLocalGateway*",
          "ec2:DeleteManagedPrefixList",
          "ec2:DeleteNatGateway",
          "ec2:DeleteNetworkAcl*",
          "ec2:DeletePlacementGroup",
          "ec2:DeletePublicIpv4Pool",
          "ec2:DeleteQueuedReservedInstances",
          "ec2:DeleteResourcePolicy",
          "ec2:DeleteRoute",
          "ec2:DeleteRouteTable",
          "ec2:DeleteSecurityGroup",
          "ec2:DeleteSnapshot",
          "ec2:DeleteSpotDatafeedSubscription",
          "ec2:DeleteSubnet",
          "ec2:DeleteSubnetCidrReservation",
          "ec2:DeleteTags",
          "ec2:DeleteTrafficMirror*",
          "ec2:DeleteTransitGateway*",
          "ec2:DeleteVolume",
          "ec2:DeleteVpc",
          "ec2:DeleteVpcEndpoints",
          "ec2:DeleteVpcEndpointConnectionNotifications",
          "ec2:DeleteVpcEndpointServiceConfigurations",
          "ec2:DeleteVpcPeeringConnection",
          "ec2:DeleteVpnConnection",
          "ec2:DeleteVpnConnectionRoute",
          "ec2:DeleteVpnGateway",
          "ec2:DeprovisionByoipCidr",
          "ec2:DeprovisionIpamPoolCidr",
          "ec2:DeprovisionPublicIpv4PoolCidr",
          "ec2:Deregister*",
          "ec2:DetachClassicLinkVpc",
          "ec2:DetachInternetGateway",
          "ec2:DetachVpnGateway",
          "ec2:Disable*",
          "ec2:DisassociateClientVpnTargetNetwork",
          "ec2:DisassociateEnclaveCertificateIamRole",
          "ec2:DisassociateRouteTable",
          "ec2:DisassociateSubnetCidrBlock",
          "ec2:DisassociateTransitGateway*",
          "ec2:DisassociateVpcCidrBlock",
          "ec2:Enable*",
          "ec2:Export*",
          "ec2:Import*",
          "ec2:ModifyAddressAttribute",
          "ec2:ModifyAvailabilityZoneGroup",
          "ec2:ModifyCapacityReservation*",
          "ec2:ModifyClientVpnEndpoint",
          "ec2:ModifyDefaultCreditSpecification",
          "ec2:ModifyEbsDefaultKmsKeyId",
          "ec2:ModifyFleet",
          "ec2:ModifyHosts",
          "ec2:ModifyIdFormat",
          "ec2:ModifyIdentityIdFormat",
          "ec2:ModifyImageAttribute",
          "ec2:ModifyInstanceCapacityReservationAttributes",
          "ec2:ModifyInstanceEventWindow",
          "ec2:ModifyInstancePlacement",
          "ec2:ModifyIpam*",
          "ec2:ModifyLocalGatewayRoute",
          "ec2:ModifyManagedPrefixList",
          "ec2:ModifyReservedInstances",
          "ec2:ModifySpotFleetRequest",
          "ec2:ModifySubnetAttribute",
          "ec2:ModifyTrafficMirror*",
          "ec2:ModifyTransitGateway*",
          "ec2:ModifyVpc*",
          "ec2:ModifyVpn*",
          "ec2:Move*",
          "ec2:Provision*",
          "ec2:Purchase*",
          "ec2:PutResourcePolicy",
          "ec2:RegisterTransitGateway*",
          "ec2:Reject*",
          "ec2:Release*",
          "ec2:ReplaceNetworkAclAssociation",
          "ec2:ReplaceNetworkAclEntry",
          "ec2:ReplaceRoute",
          "ec2:ReplaceRouteTableAssociation",
          "ec2:ReplaceTransitGatewayRoute",
          "ec2:ResetAddressAttribute",
          "ec2:ResetEbsDefaultKmsKeyId",
          "ec2:RevokeClientVpnIngress",
          "ec2:StartVpcEndpointServicePrivateDnsVerification",
          "ec2:TerminateClientVpnConnections",
          "ec2:WithdrawByoipCidr"
        ],
        "Resource": [
          "*"
        ]
      },
      {
        "Sid": "ssmConnectAllow",
        "Action": [
          "ssm:StartSession",
          "ssm:ResumeSession",
          "ssm:TerminateSession"
        ],
        "Effect": "Allow",
        "Resource": [
            "*"
        ]
      },
      {
        "Sid": "ec2RoleAllow",
        "Action": "iam:PassRole",
        "Effect": "Allow",
        "Resource": [
            "arn:aws:iam::*:role/ecsInstanceRole*"
        ],
        "Condition": {
            "StringLike": {
                "iam:PassedToService": [
                    "ec2.amazonaws.com"
                ]
            }
        }
    }
  
    ]
  }